### 2.2 工程与技术细节

#### 预处理

+ ***分词***

　　针对中文环境，一般采用开源工具+自定义词典，jieba、foolNLTK、哈工大LTP、ANJS等工具。

+ ***归一化***

　　词干化、拼写错误处理、特殊字符处理等，主要是英文环境，用NLTK。

+ ***去停用词***

　　根据场景选择性处理，load停用词典，做filter。

#### 自然语言表示

　　将自然语言数据表示成计算机能处理的数值形式。

+ ***one-hot表示***

　　onehot、tf-idf、距离归一tf-idf、lda、N-gram；工具采用sklearn、NLTK等。

+ ***distributed表示***

　　word2vec、sentence2vec、GloVe；工具采用gensim自己训练或者直接下载已经训练好的词向量，值得注意的是，分词方法需要统一。

#### 自然语言理解

　　主要负责自然语言输入的解析、结构化、场景分类等。

+ ***命名实体识别/词槽填充***

　　序列标注问题，候选方案有：条件随机场、RNN（[注意力RNN词槽填充论文](https://arxiv.org/abs/1609.01454)）、SVM

+ ***文本分类&Rank***

　　各种分类模型

+ ***文本相似度***

　　word2vec、编辑距离、等

+ ***指代消歧***

+ ***情感分析***

　　情感字典、情感分类/打分、语法分析

+ ***文本匹配***

Locality Sensitive Hashing ；若每次用户提问时都与知识库中几十万个高维稀疏向量中算cosin 是不现实的、时间复杂度不可接受，可以使用Locality Sensitive Hashing，这种hash可以把距离很近的数据以较高的概率映射成同一个hash值。sklearn中的LSHForest就是这种思路，但它检索慢、recall 低，这里用的Facebook research的pysparnn、但它也有个缺点：建index慢，好在建index是一次性的、建好后用cPickle持久化，以后用时load就好了


#### （四）会话管理「DST」

　　负责会话全程管理、模式切换、和其他API交互等综合功能，是chatbot后端核心之一。

+ ***控制中心***

　　强中心，控制中心对对话进行服务分类，对分类服务直接调用，返回对应服务结果，冷启动难度较高、分类结果精度要求较高，易扩展、易优化；

　　弱中心，每个服务有自己的意图识别模块（二分类），中心汇总并对置信度最高的服务进行服务访问，有点在于启动容易，难点在于后期维护、开发较困难。

+ ***有限状态机FSM***

　　FSM的一个特点在于如果限定了用户的action，那么，所有的状态就非常可控，所以FSM非常实用于各种点餐系统，订票系统，支付系统等，这些系统的所有状态都是固定的，用户也无法随意输入，只能按照指定的action集合，选取其中的一种（其实各种服务电话的流程，也都是这样，来引导用户进入对应期望的服务），系统一旦形成，交互的闭环也就形成，所有状态的跳转也固化下来，效率非常高，故而，FSM只适用于用户的可能状态和可能action都被限定的情况。

+ ***slot_map + user_state***

　　用户没有一个非常具体的状态，但是有一个阶段性的状态，在这个阶段里面，必须填充好slot_map中的某些字段，然后进入下一个阶段，这样，极大地限制了状态的数量，又能够按照slot_map中信息的优先级，自然而然地将非线性的状态跳转转化成线性的状态遍历（可能后面的状态先得到满足信息，那就先放着，没关系），复杂度非常可控。

+ ***语境知识维护***

+ ***动态用户画像***

#### （五）动作候选「Policy Rank」

#### （六）自然语言生成「NLG」

+ ***seq2seq***

[seq2seq奠基论文]()

+ ***QA检索***

+ ***查询API返回***


*部分内容引用自：
[意图识别与槽填充](http://blog.csdn.net/u013713117/article/details/54974363)；
[利用有限状态机思想实闭环多轮交互](http://blog.sina.com.cn/s/blog_6d5750540102wbje.html)
*
